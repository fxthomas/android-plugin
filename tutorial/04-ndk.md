---
layout: post
title: 4. Using the NDK
subtitle: Compiling native Android libraries
---

SBT-Android can also manage NDK builds, which are explained in this section.

Since SBT-Android directly uses the NDK build system, you should first be
familiar with the concepts explained in the [Android
documentation](http://developer.android.com/tools/sdk/ndk/index.html).

--------------------

NDK sources should be put in `src/main/jni` by default, and the NDK build
process will be activated as soon as you create this directory.

The bare minimum you generally need in one `Android.mk` file in the `jni/`
directory. Here is an example :

```makefile
LOCAL_PATH:= $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE     := mylib
LOCAL_CFLAGS     := -Werror
LOCAL_SRC_FILES  := mylib.c
LOCAL_LDLIBS     := -llog -lmyotherlib

LOCAL_C_INCLUDES := ${SBT_MANAGED_JNI_INCLUDE}
LOCAL_LDFLAGS    := -I${SBT_UNMANAGED_BASE}

include $(BUILD_SHARED_LIBRARY)
```

Did you notice the variables starting with `SBT`? They are setup so that you
can safely include files managed by SBT, respectively :

  * Headers generated by `javah`, configured with :

    ```scala
    // Tell SBT to output headers for this class with native methods
    jniClasses += "com.scratch.MyClassWithNative"

    // Set the output directory
    javahOutputDirectory := file("some/directory")

    // Output one header per class having native methods
    javahOutputFile := None

    // Output one global header file called native.h
    javahOutputFile := Some("native.h")
    ```

  * Existing libraries in the `unmanaged-native-path` directory.

    Note that, if you put a file called `libmyotherlib.so` in `lib/armeabi/`,
    it will be automatically selected when building an `armeabi` artifact.
